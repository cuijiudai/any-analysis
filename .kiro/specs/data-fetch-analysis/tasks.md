# 实施计划

- [x] 1. 项目初始化和基础架构搭建

  - 创建 NestJS 后端项目结构，配置 TypeScript 和基础依赖
  - 创建 React 前端项目，配置 Ant Design 和基础路由
  - 配置 MySQL 数据库连接和 TypeORM
  - 设置项目的基础配置文件和环境变量
  - _需求: 6.1, 6.2_

- [x] 2. 数据库设计和实体创建

  - 创建数据库和基础表结构（data_sessions, fetch_configs 等）
  - 实现 TypeORM 实体类（DataSession, FetchConfig, FieldAnnotation, ChartConfig）
  - 创建数据表结构管理实体（DataTableSchema）
  - 编写数据库迁移脚本和初始化脚本
  - _需求: 6.3, 6.4_

- [ ] 3. 后端核心服务层实现

  - [x] 3.1 实现数据会话管理服务

    - 创建 DataSessionService，处理会话的创建、查询、删除
    - 实现会话状态管理和状态转换逻辑
    - 编写会话相关的单元测试
    - _需求: 2.7, 7.2_

  - [x] 3.2 实现 HTTP 客户端服务

    - 创建可配置的 HTTP 客户端，支持自定义请求头
    - 实现请求重试机制和错误处理
    - 添加请求日志和监控功能
    - _需求: 1.1, 2.6_

  - [x] 3.3 实现 curl 解析服务
    - 创建 CurlParserService，解析 curl 命令提取配置信息
    - 支持 URL、请求头、查询参数、请求体的解析
    - 处理多行 curl 命令和特殊字符转义
    - 编写 curl 解析的单元测试
    - _需求: 2.7, 2.8_

- [x] 4. 冒烟测试功能实现

  - [x] 4.1 实现冒烟测试后端 API

    - 创建 smoke-test 端点，执行无痕 API 测试
    - 实现样本数据获取和基础验证逻辑
    - 确保不创建任何数据库记录或持久化数据
    - _需求: 1.2, 1.3, 1.4_

  - [x] 4.2 实现冒烟测试前端组件
    - 创建 SmokeTestButton 组件，触发测试并显示结果
    - 实现测试结果的实时显示和错误处理
    - 添加测试状态的加载指示器
    - _需求: 1.1, 1.5, 1.6_

- [ ] 5. 数据拉取配置功能实现

  - [x] 5.1 实现拉取配置后端服务

    - 创建 FetchConfigService，处理配置的保存和验证
    - 实现分页模式和全部模式的配置逻辑
    - 添加配置参数的验证和默认值处理
    - _需求: 2.1, 2.2, 2.3, 2.4, 2.5_

  - [x] 5.2 实现拉取配置前端表单
    - 创建 FetchConfigForm 组件，包含所有配置选项
    - 实现 FetchModeSelector，支持分页和全部模式切换
    - 集成 CurlParserModal，支持 curl 命令导入
    - 添加表单验证和用户友好的错误提示
    - _需求: 2.1, 2.2, 2.7, 7.6_

- [ ] 6. 动态表结构管理实现

  - [x] 6.1 实现数据结构分析服务

    - 创建 SchemaAnalysisService，分析 API 返回数据的字段类型
    - 实现 MySQL 数据类型推断逻辑（VARCHAR, INT, DECIMAL 等）
    - 处理嵌套对象和数组类型的扁平化
    - _需求: 3.2, 6.3_

  - [x] 6.2 实现动态表创建服务
    - 创建 DynamicTableService，根据分析结果创建专用数据表
    - 实现表结构的 DDL 生成和执行
    - 添加表名管理和冲突处理逻辑
    - 编写动态表操作的单元测试
    - _需求: 3.3, 6.3_

- [ ] 7. 正式数据拉取功能实现

  - [x] 7.1 实现数据拉取执行服务

    - 创建 DataFetchExecutorService，执行正式数据拉取
    - 实现分页拉取和全部拉取的不同逻辑
    - 添加拉取进度跟踪和状态更新
    - 实现数据的批量插入和事务处理
    - _需求: 3.1, 3.4, 3.5_

  - [x] 7.2 实现拉取进度监控

    - 创建进度跟踪 API，实时返回拉取状态
    - 实现 WebSocket 或轮询机制更新前端进度
    - 添加拉取错误的详细日志和恢复机制
    - _需求: 3.5, 7.3_

  - [x] 7.3 实现数据预览功能
    - 创建 DataPreview 组件，分页展示拉取的数据
    - 实现响应式表格布局和虚拟滚动
    - 添加数据搜索和基础筛选功能
    - _需求: 3.7, 7.7_

- [ ] 8. 字段标注功能实现

  - [x] 8.1 实现字段标注后端服务

    - 创建 FieldAnnotationService，管理字段标注信息
    - 实现智能标注推断逻辑（基于字段名称）
    - 添加标注的保存、更新、删除功能
    - _需求: 4.1, 4.3, 4.5_

  - [x] 8.2 实现字段标注前端组件
    - 创建 FieldAnnotationForm，展示所有字段的标注界面
    - 实现 FieldList 组件，支持批量编辑和验证
    - 添加标注进度指示和必填字段验证
    - _需求: 4.2, 4.4, 4.6_

- [ ] 9. 数据分析表格展示实现

  - [x] 9.1 实现数据查询和筛选服务

    - 创建 DataAnalysisService，处理复杂的数据查询
    - 实现多字段筛选和排序功能
    - 添加分页查询和性能优化
    - _需求: 5.1, 5.8_

  - [x] 9.2 实现数据表格组件
    - 创建 DataTable 组件，展示带标注的数据表格
    - 实现 FilterPanel，提供字段类型相关的筛选选项
    - 添加表格的导出和打印功能
    - _需求: 5.2, 5.3, 7.7_

- [x] 10. 图表分析功能实现

  - [x] 10.1 实现图表数据处理服务

    - 创建 ChartDataService，处理图表数据的聚合和计算
    - 实现不同聚合方式（求和、平均值、计数）的逻辑
    - 添加图表数据的缓存和性能优化
    - _需求: 5.5, 5.6_

  - [x] 10.2 实现图表展示组件

    - 创建 ChartContainer 组件，集成 ECharts 图表库
    - 实现折线图、柱状图、饼图的配置和渲染
    - 添加图表的交互功能和数据钻取
    - _需求: 5.4, 5.5_

  - [x] 10.3 实现图表配置管理
    - 创建 ChartConfigModal，支持图表配置的保存和管理
    - 实现图表配置的 CRUD 操作和列表展示
    - 添加图表配置的导入导出功能
    - _需求: 5.7, 5.9_

- [ ] 11. 历史配置管理实现

  - [ ] 11.1 实现历史会话管理服务

    - 扩展 DataSessionService，添加会话列表和详情查询
    - 实现会话的删除和数据清理功能
    - 添加会话统计信息的计算
    - _需求: 7.2_

  - [ ] 11.2 实现历史配置前端页面
    - 创建 HistoryPage，展示所有历史会话
    - 实现 SessionList 和 SessionCard 组件
    - 添加会话的搜索、筛选和批量操作功能
    - _需求: 7.2_

- [ ] 12. 响应式布局和用户体验实现

  - [ ] 12.1 实现步骤向导组件

    - 创建 StepWizard 组件，管理三步骤的导航和状态
    - 实现 StepNavigation，提供清晰的步骤指示
    - 添加步骤间的数据传递和状态保持
    - _需求: 7.1, 7.2_

  - [ ] 12.2 实现响应式布局
    - 创建 ResponsiveContainer，适配不同屏幕尺寸
    - 实现移动端的配置面板折叠功能
    - 添加布局的用户偏好设置和记忆功能
    - _需求: 7.5, 7.8_

- [ ] 13. 错误处理和用户反馈实现

  - [ ] 13.1 实现全局错误处理

    - 创建全局异常过滤器和错误处理中间件
    - 实现用户友好的错误信息展示
    - 添加错误日志记录和监控
    - _需求: 7.4_

  - [ ] 13.2 实现加载状态和进度指示
    - 创建 LoadingSpinner 和 ProgressBar 组件
    - 实现各个操作的加载状态管理
    - 添加操作成功的反馈提示
    - _需求: 7.3_

- [ ] 14. 测试和质量保证

  - [ ] 14.1 编写单元测试

    - 为所有服务类编写单元测试，确保业务逻辑正确
    - 为关键组件编写前端单元测试
    - 实现测试数据工厂和 Mock 服务
    - _需求: 所有功能需求_

  - [ ] 14.2 编写集成测试
    - 编写 API 端点的集成测试
    - 测试数据库操作和事务处理
    - 验证端到端的用户流程
    - _需求: 所有功能需求_

- [ ] 15. 部署和文档

  - [ ] 15.1 准备生产环境配置

    - 配置生产环境的数据库连接和环境变量
    - 实现应用的构建和部署脚本
    - 添加健康检查和监控配置
    - _需求: 6.1, 6.2_

  - [ ] 15.2 编写用户文档
    - 编写 API 文档和使用说明
    - 创建用户操作指南和常见问题解答
    - 准备系统部署和维护文档
    - _需求: 7.6_
